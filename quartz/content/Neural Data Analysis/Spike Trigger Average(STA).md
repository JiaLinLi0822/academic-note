[Spike Trigger Averages (STA): Understanding Neural Spike Stimuli with Python](https://medium.com/@baxterbarlow/spike-trigger-averages-sta-understanding-neural-spike-stimuli-via-mathematical-analysis-and-9013fcfa11b9)

## Introduction

- 神经脉冲是神经系统通讯的基础单位。当神经元接受来自周围神经元充足的输入时，神经元会由于细胞膜电位的改变而产生短暂的，全或无的电脉冲。
    
- 这种电脉冲会刺激其他神经元、肌肉或腺体。这样，神经脉冲就是神经元编码和传递信息的方式。
    
- 这些电脉冲对于人类的功能非常重要，从简单的反射到复杂的认知过程如思考和记忆
    
- 神经科学的主要挑战之一是确定神经脉冲如何编码特定刺激。神经反应可能非常复杂，受许多因素影响，包括刺激呈现的背景、神经回路的状态以及先前刺激的历史。
    
- 此外，神经元通常会同时对刺激的多个方面做出反应，因此很难区分每个特征的贡献。
    
    - 例如，视觉皮层中的神经元可能对视觉刺激的方向和运动都有反应，因此很难确定哪个特征在驱动反应。
- 理解这些复杂性需要复杂的分析工具，其中之一就是脉冲触发平均值 (STA)。STA 通过关注神经脉冲之前的平均刺激，帮助研究人员简化刺激与神经反应之间的关系。这种方法可以揭示神经元如何编码信息的基本特性，并已成为神经科学领域的一项基石技术。
    

## Neural Response Function and Firing Rates

Although action potentials can vary somewhat in duration, amplitude and shape, they are typically treated as identical stereotyped events in neural encoding studies. Ignoring the brief duration of action potentials (~1ms), an action potential sequence can be described simply as a list of times when the spikes occurred.

For n spikes, with $t_i$ denoting the time of the $i$th spike, the neural response function $\rho(t)$, can be represented by the following equation:

$$ \rho(t)=\sum_{i=1}^n \delta(t-t_i) $$

![Visualization of an example neural response function](https://prod-files-secure.s3.us-west-2.amazonaws.com/dbe8abbb-2ec1-4483-98c3-5d57b95e29bf/7d91359a-ffd9-4fd5-92f6-7e10d0d956c8/Screenshot_2024-12-10_at_2.29.17_PM.png)

Visualization of an example neural response function

Because the sequence of action potentials generated by a given stimulus vary from trial to trial, neuronal responses are typically treated statistically/probabilistically. Thus, they may often be characterized by firing rates rather than specific spike sequences. One such characterization is what is called the **spike-count rate**, _r_, which is calculated by counting the number of APs that appear during a trial by the duration of the trial.

$$ r = \frac{n}{T}=\frac{1}{T}\int_0^T\rho(\tau)d\tau $$

This value can be derived by a single trial, at the expense of losing all temporal resolution about how the neural response varies over the course of the trial. We can however define a time-dependent firing rate by counting spikes over short time intervals, but this can then no longer be computed from a single trial.

We can however define a time-dependent firing rate by counting spikes over short time intervals, but this can then no longer be computed from a single trial. For example, if we counted spikes within a certain window _[t, t + Δt]_ for some small interval _Δt_ and dividing the count by _Δt_, we could obtain a high temporal resolution definition. But, for small _Δt_, the spike count of each interval would then become only one of two values: 0 or 1.

However, we can solve this issue by averaging over multiple trials. Thus we define the **time-dependent firing rate** as the average number of spikes (averaged over trials) appearing during a short interval between times _t_ and _t + Δt_, divided by the duration of the interval:

$$ r(t)=\frac{1}{\Delta t}\int_t^{t+\Delta t}<\rho(\tau)>d\tau $$

with angle brackets denoting averages over trials of the sam stimulus.

![Screenshot 2024-12-10 at 2.59.46 PM.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/dbe8abbb-2ec1-4483-98c3-5d57b95e29bf/7f16875c-bb1a-4989-bb65-1d538d57565b/Screenshot_2024-12-10_at_2.59.46_PM.png)